DROP TABLE IF EXISTS ADDRESS CASCADE;
DROP TABLE IF EXISTS ROLE CASCADE;
DROP TABLE IF EXISTS USERS CASCADE;

CREATE TABLE ADDRESS (
    ID                  BIGINT GENERATED BY DEFAULT AS IDENTITY,
    ADDRESS_LINE_01     VARCHAR(255),
    ADDRESS_LINE_02     VARCHAR(255),
    CITY                VARCHAR(255),
    STATE               VARCHAR(255),
    ZIP_CODE            VARCHAR(255),
    USER_ID             BIGINT UNIQUE,
    CREATED_DATE        TIMESTAMP,
    CREATED_BY          BIGINT,
    LAST_MODIFIED_DATE  TIMESTAMP,
    LAST_MODIFIED_BY    BIGINT,
    PRIMARY KEY (ID)
);

CREATE TABLE ROLE (
    ID BIGINT           GENERATED BY DEFAULT AS IDENTITY,
    NAME                VARCHAR(255) CHECK (NAME IN ('DEVELOPER','MODELER','DBA','USER','ADMIN')),
    CREATED_DATE        TIMESTAMP,
    LAST_MODIFIED_DATE  TIMESTAMP,
    PRIMARY KEY (ID),
    UNIQUE (NAME)
);

CREATE TABLE USERS (
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY,
    FIRST_NAME         VARCHAR(40),
    LAST_NAME          VARCHAR(40),
    USER_NAME          VARCHAR(20),
    ENCRYPTED_PASSWORD VARCHAR(100),
    PHONE              VARCHAR(30),
    EMAIL              VARCHAR(40),
    ROLE_ID            BIGINT,
    CREATED_DATE       TIMESTAMP,
    LAST_MODIFIED_DATE TIMESTAMP,
    PRIMARY KEY (ID),
    CONSTRAINT UK5KC281QC17PLOO981QFHOWGK7 UNIQUE (USER_NAME),
    CONSTRAINT UKKU29J688XLCI1KSOPVJFGPSWP UNIQUE (EMAIL)
);

ALTER TABLE IF EXISTS ADDRESS
ADD CONSTRAINT FK6I66IJB8TWGCQTETL8EEEED6V
FOREIGN KEY (USER_ID)
REFERENCES USERS;

ALTER TABLE IF EXISTS USERS
ADD CONSTRAINT FK4QU1GR772NNF6VE5AF002RWYA
FOREIGN KEY (ROLE_ID)
REFERENCES ROLE;